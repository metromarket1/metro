<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="metrologo.jpeg">
    <title>طلبات الموظفين - Metro</title>

    <style>
        body {
            font-family: sans-serif;
            background: #f0f2f5;
            padding: 20px;
            max-width: 500px;
            margin: auto;
        }

        .card {
            background: #fff;
            padding: 24px;
            border-radius: 18px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 26px;
        }

        .logo-container {
            text-align: center;
            margin-bottom: 16px;
        }

        .logo {
            width: 150px;
            border-radius: 12px;
        }

        .section-title {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin: 10px 0 14px;
            color: #222;
        }

        /* Slider */
        .slider {
            position: relative;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
            margin-bottom: 20px;
        }

        .slides img {
            width: 100%;
            display: none;
            object-fit: cover;
        }

        .slides img.active {
            display: block;
        }

        .slider-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            border: none;
            background: rgba(0, 0, 0, 0.45);
            color: #fff;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            line-height: 32px;
            text-align: center;
        }

        .slider-nav.prev {
            right: 10px;
        }

        .slider-nav.next {
            left: 10px;
        }

        .slider-dots {
            text-align: center;
            padding: 8px 0 4px;
            background: #fff;
        }

        .dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            margin: 0 3px;
            border-radius: 50%;
            background: #ccc;
            cursor: pointer;
        }

        .dot.active {
            background: #0d6efd;
        }

        /* Form styling */
        label {
            display: block;
            margin-top: 14px;
            margin-bottom: 6px;
            font-weight: 600;
            color: #444;
        }

        input,
        select {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid #ccc;
            background: #fafafa;
            font-size: 15px;
            box-sizing: border-box;
            -webkit-appearance: none;
            appearance: none;
        }

        /* Order Blocks */
        .order-item {
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #fafafa;
            margin-top: 20px;
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .order-title {
            margin: 0;
            color: #444;
        }

        .order-row {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .qty-input {
            flex: 1;
            padding: 10px;
            border-radius: 10px;
            border: 1px solid #ccc;
            text-align: center;
            background: #fff;
        }

        .order-select {
            flex: 3;
        }

        .delete-order-btn {
            background: #d9534f;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
        }

        /* Add order button */
        .add-order-btn {
            background: #ff9800;
            width: auto;
            padding: 8px 14px;
            font-size: 14px;
            margin-top: 10px;
            border-radius: 8px;
            color: white;
            border: none;
            cursor: pointer;
        }

        /* Main submit button */
        .submit-btn {
            width: 100%;
            padding: 14px;
            background: #0d6efd;
            color: #fff;
            border: none;
            margin-top: 22px;
            border-radius: 12px;
            font-size: 17px;
            cursor: pointer;
            font-weight: bold;
            letter-spacing: .3px;
        }

        .submit-btn:hover {
            opacity: 0.9;
        }
    </style>
</head>

<body>

    <div class="card">

        <div class="logo-container">
            <img src="metrologo.jpeg" class="logo" alt="Metro Logo">
        </div>

        <div class="section-title">قائمة الطعام</div>

        <!-- Slider -->
        <div class="slider">
            <div class="slides">
                <img src="menu1.jpeg" class="slide active">
                <img src="menu2.jpeg" class="slide">
            </div>

            <button class="slider-nav prev" onclick="changeSlide(-1)">‹</button>
            <button class="slider-nav next" onclick="changeSlide(1)">›</button>

            <div class="slider-dots">
                <span class="dot active" onclick="goToSlide(0)"></span>
                <span class="dot" onclick="goToSlide(1)"></span>
            </div>
        </div>

        <!-- Form -->
        <label>اختر الشركة</label>
        <select id="companySelect">
            <option value="غير محدد" selected>اختياري</option>
            <option value="الشركة أ">الشركة أ</option>
            <option value="الشركة ب">الشركة ب</option>
            <option value="الشركة ج">الشركة ج</option>
        </select>

        <label>اسم الموظف</label>
        <input type="text" id="nameInput" placeholder="اكتب اسمك هنا">

        <label>رقم الهاتف</label>
        <input type="tel" id="phoneInput" placeholder="059XXXXXXX">

        <!-- Orders -->
        <div id="ordersContainer">
            <div class="order-item">
                <div class="order-header">
                    <h3 class="order-title">الوجبة رقم 1</h3>
                </div>
                <label>اختيار الفئة</label>
                <select class="categorySelect order-select">
                    <option value="">اختر الفئة</option>
                    <option value="sandwiches" selected>سندويشات</option>
                    <option value="salads">سلطات</option>
                    <option value="starters">مقبلات</option>
                    <option value="drinks">مشروبات</option>
                </select>


                <label>اختيار الوجبة</label>

                <div class="order-row">
                    <select class="orderSelect order-select"></select>

                    <input type="number" class="orderQty qty-input" min="1" value="1">
                </div>

                <div class="notesWrapper">
                    <label>ملاحظات على الوجبة</label>
                    <input type="text" class="notesInput" placeholder="أي ملاحظات إضافية">
                </div>

            </div>
        </div>

        <button id="addOrderBtn" type="button" class="add-order-btn">إضافة وجبة</button>
        <div id="totalContainer" style="
            margin-top:15px;
            font-size:18px;
            font-weight:bold;
            color:#333;
            ">
            إجمالي السعر: 0 شيكل
        </div>

        <label>وقت التوصيل</label>
        <select id="timeSelect"></select>

        <button onclick="sendToWhatsApp()" class="submit-btn">إرسال الطلب</button>

    </div>

    <script>
        const menuData = {
            sandwiches: {
                "نقانق و جبنة": 18,
                "أفوكادو و بيض": 18,
                "مترو مكس": 20,
                "تونة": 20,
                "حلومي": 24,
                "دجاج كرسبي": 25,
                "أفوكادو و دجاج": 27,
                "دجاج وايت صوص": 27,
                "شاورما دجاج": 25,
                "برغر دجاج": 25,
                "برغر لحمة": 30,
                "لحمة كرانشي": 30,
                "ساندويش كفتة": 30,
                "سلمون مدخّن": 35
            },
            salads: {
                "سلطة سيزر": 22,
                "سلطة يونانية": 22,
                "سلطة التفاح الأخضر": 22,
                "وجبة صحية مع اريش": 25,
                "سلطة معكرونة": 25,
                "تبولة كينوا": 25,
                "سلطة تونة وأفوكادو": 27,
                "سلطة سوبر": 30
            },
            starters: {
                "بطاطا سادة": 10,
                "بطاطا ويدجز": 12,
                "بطاطا مع تشيدر وهالبينو": 14,
                "بطاطا كيرلي": 14,
                "مكس بوكس": 18,
                "بطاطا مع دجاج كريسبي": 25,
                "أصابع كريسبي وصوصات": 30
            },
            drinks: {
                "عصير برتقال": 12,
                "عصير شمندر": 12,
                "عصير أخضر": 12
            }
        };


        document.querySelectorAll(".categorySelect").forEach(select => {
            select.addEventListener("change", e => {
                const item = e.target.closest(".order-item");
                updateMealOptions(item);
                updateTotal();
                toggleNotesVisibility(item);
            });
        });


        function updateTotal() {
            let total = 0;

            const orders = document.querySelectorAll(".order-item");

            orders.forEach(item => {
                const meal = item.querySelector(".orderSelect").value;
                let price = 0;

                // Find price in menuData
                for (const category in menuData) {
                    if (menuData[category][meal] !== undefined) {
                        price = menuData[category][meal];
                        break;
                    }
                }

                const qty = parseInt(item.querySelector(".orderQty").value) || 0;
                total += price * qty;
            });

            document.getElementById("totalContainer").textContent =
                `إجمالي السعر: ${total} شيكل`;

            return total;
        }


        function sendToWhatsApp() {
            const total = updateTotal();
            const name = document.getElementById("nameInput").value || 'غير محدد';
            const phone = document.getElementById("phoneInput").value || 'غير محدد';
            const dept = document.getElementById("companySelect").value;
            const time = document.getElementById("timeSelect").value;

            const orders = document.querySelectorAll(".order-item");
            let orderMsg = "";

            orders.forEach((item, index) => {
                const order = item.querySelector(".orderSelect").value;
                const qty = item.querySelector(".orderQty").value;
                const notes = item.querySelector(".notesInput").value || "لا توجد";

                orderMsg += `%0A--- الطلب رقم ${index + 1} ---` +
                    `%0Aالطلب: ${encodeURIComponent(order)}` +
                    `%0Aالعدد: ${encodeURIComponent(qty)}` +
                    `%0Aملاحظات: ${encodeURIComponent(notes)}%0A`;
            });

            const msg =
                "وجبة جديدة: " +
                `%0Aالاسم: ${encodeURIComponent(name)}` +
                `%0Aالهاتف: ${encodeURIComponent(phone)}` +
                `%0Aالشركة: ${encodeURIComponent(dept)}` +
                `%0Aوقت التوصيل: ${encodeURIComponent(time)}` +
                `%0Aإجمالي السعر: ${total} شيكل` +
                `%0A${orderMsg}`;
            window.location.href = `https://wa.me/972566000166?text=${msg}`;


        }

        document.getElementById("addOrderBtn").addEventListener("click", addNewOrder);

        function addNewOrder() {
            const container = document.getElementById("ordersContainer");

            const newOrder = document.createElement("div");
            newOrder.classList.add("order-item");

            newOrder.innerHTML = `
        <div class="order-header">
            <h3 class="order-title">الوجبة رقم</h3>
            <button type="button" class="delete-order-btn">حذف الطلب</button>
        </div>

        <label>اختيار الفئة</label>
        <select class="categorySelect order-select">
            <option value="sandwiches" selected>سندويشات</option>
            <option value="salads">سلطات</option>
            <option value="starters">مقبلات</option>
            <option value="drinks">مشروبات</option>
        </select>

        <label>اختيار الوجبة</label>

        <div class="order-row">
            <select class="orderSelect order-select"></select>
            <input type="number" class="orderQty qty-input" min="1" value="1">
        </div>

       <div class="notesWrapper">
        <label>ملاحظات على الوجبة</label>
        <input type="text" class="notesInput" placeholder="أي ملاحظات إضافية">
        </div>

    `;

            container.appendChild(newOrder);

            // Load default category meals (sandwiches)
            updateMealOptions(newOrder);

            // Attach listeners
            newOrder.querySelector(".categorySelect").addEventListener("change", () => {
                updateMealOptions(newOrder);
                updateTotal();
                toggleNotesVisibility(newOrder);
            });

            newOrder.querySelector(".orderSelect").addEventListener("change", updateTotal);
            newOrder.querySelector(".orderQty").addEventListener("input", updateTotal);

            newOrder.querySelector(".delete-order-btn").addEventListener("click", () => {
                newOrder.remove();
                updateOrderNumbers();
                updateTotal();
            });

            updateOrderNumbers();
            updateTotal();
        }

        function toggleNotesVisibility(orderItem) {
            const category = orderItem.querySelector(".categorySelect").value;
            const notesWrapper = orderItem.querySelector(".notesWrapper");

            if (category === "drinks") {
                notesWrapper.style.display = "none";
            } else {
                notesWrapper.style.display = "block";
            }
        }


        function updateOrderNumbers() {
            const titles = document.querySelectorAll(".order-title");
            titles.forEach((t, i) => {
                t.textContent = `الوجبة رقم ${i + 1}`;
            });
        }
        const timeSelect = document.getElementById("timeSelect");
        const companySelect = document.getElementById("companySelect");

        // Delivery times per company
        const deliveryTimes = {
            "غير محدد": [],
            "الشركة أ": ["10:00 صباحاً", "11:00 صباحاً"],
            "الشركة ب": ["11:30 صباحاً", "12:30 ظهراً"],
            "الشركة ج": ["1:00 ظهراً", "2:00 ظهراً"]
        };

        // Function to update delivery time options
        function updateDeliveryTimes() {
            const selectedCompany = companySelect.value;
            const times = deliveryTimes[selectedCompany] || [];

            // Clear previous options
            timeSelect.innerHTML = "";

            if (times.length === 0) {
                timeSelect.innerHTML = `<option value="">اختر الشركة أولاً</option>`;
                return;
            }

            times.forEach(t => {
                const opt = document.createElement("option");
                opt.textContent = t;
                opt.value = t;
                timeSelect.appendChild(opt);
            });
        }

        // Update when company changes
        companySelect.addEventListener("change", updateDeliveryTimes);
        function updateMealOptions(orderItem) {
            const category = orderItem.querySelector(".categorySelect").value;
            const mealSelect = orderItem.querySelector(".orderSelect");

            mealSelect.innerHTML = "";  // clear old options

            if (!category || !menuData[category]) {
                mealSelect.innerHTML = `<option value="">اختر الفئة أولاً</option>`;
                return;
            }

            for (const meal in menuData[category]) {
                const opt = document.createElement("option");
                opt.value = meal;
                opt.textContent = meal;
                mealSelect.appendChild(opt);
            }
        }

        // Run once on page load
        updateDeliveryTimes();
        updateTotal();
        window.addEventListener("load", () => {
            const firstOrder = document.querySelector(".order-item");
            updateMealOptions(firstOrder);
            toggleNotesVisibility(firstOrder);
        });

        let currentSlide = 0;

        function showSlide(index) {
            const slides = document.querySelectorAll('.slide');
            const dots = document.querySelectorAll('.dot');

            if (index < 0) index = slides.length - 1;
            if (index >= slides.length) index = 0;

            slides.forEach((img, i) => {
                img.classList.toggle('active', i === index);
            });

            dots.forEach((dot, i) => {
                dot.classList.toggle('active', i === index);
            });

            currentSlide = index;
        }

        function changeSlide(step) {
            showSlide(currentSlide + step);
        }

        function goToSlide(index) {
            showSlide(index);
        }

        document.querySelector(".orderSelect").addEventListener("change", updateTotal);
        document.querySelector(".orderQty").addEventListener("input", updateTotal);
    </script>

</body>

</html>